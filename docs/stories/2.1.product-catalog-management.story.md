# Story 2.1: Product Catalog Management

## Status

Approved

## Story

**As a** shop owner,
**I want** to create and manage my product catalog with essential details,
**so that** I can build a comprehensive inventory of items I sell

## Prerequisites

- Story 1.1 (User & Shop Onboarding) must be completed
- Story 1.2 (Password reset account recovery) must be completed
- Story 1.3 (Module Selection Interface) must be completed
- User should access this functionality via the Product Management module

## Acceptance Criteria

1. User can access Product Management from the module selection page at `/{shopusername}/modules`
2. Product Management page replaces the current placeholder implementation
3. User can add new products with name, base price, and profit margin
4. User can edit existing product details
5. User can view a list of all products in their catalog
6. User can delete products (with confirmation)
7. User can search products by name, category, and stock status
8. User can organize products into categories, using tabs
9. Product form validates required fields
10. Product list shows stock status and basic information
11. User can navigate back to module selection via "Back to Modules" button

## Tasks / Subtasks

- [ ] Task 1: Create product data models and API (AC: 1-8)
  - [ ] Implement Product schema with required fields
  - [ ] Create product CRUD API endpoints
  - [ ] Add product search and filtering functionality
  - [ ] Implement category management system
- [ ] Task 2: Build product management UI components (AC: 1-8)
  - [ ] Create ProductForm component for add/edit
  - [ ] Build ProductList component with search and filters
  - [ ] Implement ProductCard component for individual products
  - [ ] Add CategorySelector component
- [ ] Task 3: Implement product CRUD operations (AC: 1-4)
  - [ ] Create add product functionality with validation
  - [ ] Implement edit product with pre-populated form
  - [ ] Add delete product with confirmation dialog
  - [ ] Build product list with pagination
- [ ] Task 4: Add search and organization features (AC: 5-6)
  - [ ] Implement product search by name, category, and stock status
  - [ ] Add category-based filtering 
  - [ ] Create category management interface
  - [ ] Add sorting options (name, price, stock)
- [ ] Task 5: Implement form validation and UX (AC: 7-8)
  - [ ] Add required field validation
  - [ ] Implement real-time form validation
  - [ ] Add loading states and success feedback
  - [ ] Create responsive design for mobile/desktop

## Dev Notes

### Previous Story Insights

This story builds on Epic 1 (User & Shop Onboarding) and requires the authentication system and shop setup to be complete.

### Data Models

**Product Schema:**

- `shop`: { type: ObjectId, ref: 'Shop', required: true }
- `name`: { type: String, required: true, trim: true }
- `description`: { type: String, trim: true }
- `basePrice`: { type: Number, required: true, min: 0 }
- `marginInCurrency`: { type: Number, min: 0 }
- `sellingPrice`: { type: Number, required: true, min: 0 }
- `category`: { type: String, trim: true }
- `stock`: { type: Number, default: 0, min: 0 }
- `sku`: { type: String, unique: true, sparse: true }
- `isActive`: { type: Boolean, default: true }
- `createdAt`: { type: Date, default: Date.now }
- `updatedAt`: { type: Date, default: Date.now }

**Category Schema:**

- `shop`: { type: ObjectId, ref: 'Shop', required: true }
- `name`: { type: String, required: true, trim: true }
- `description`: { type: String, trim: true }
- `color`: { type: String, default: '#3B82F6' }
- `isActive`: { type: Boolean, default: true }

[Source: docs/architecture/01-system-architecture-document-saral-vyapar.md#4.3 Database (Persistence)]

### API Specifications

**Product Endpoints:**

- `POST /api/products` - Create new product
- `GET /api/products` - Get products with search/filter/pagination
- `GET /api/products/:id` - Get single product
- `PUT /api/products/:id` - Update product
- `DELETE /api/products/:id` - Delete product

**Category Endpoints:**

- `POST /api/categories` - Create new category
- `GET /api/categories` - Get shop categories
- `PUT /api/categories/:id` - Update category
- `DELETE /api/categories/:id` - Delete category

**Query Parameters:**

- `search` - Product name search
- `category` - Filter by category
- `stock` - Filter by stock status (in-stock, low-stock, out-of-stock)
- `sort` - Sort by name, price, stock, date
- `page` - Pagination page number
- `limit` - Items per page

### Component Specifications

**Frontend Components:**

- `ProductForm` - Add/edit product form with validation
- `ProductList` - Product grid/list with search and filters
- `ProductCard` - Individual product display card
- `CategorySelector` - Category dropdown/selector
- `ProductSearch` - Search input with suggestions
- `ProductFilters` - Filter controls for category, stock, etc.

**Form Fields:**

- Product name (required)
- Description (optional)
- Base price (required, numeric)
- Profit margin (optional, numeric)
- Category (dropdown with create option)
- Initial stock (optional, numeric)
- SKU (optional, unique)

### File Locations

- `src/components/products/ProductForm.tsx`
- `src/components/products/ProductList.tsx`
- `src/components/products/ProductCard.tsx`
- `src/components/products/CategorySelector.tsx`
- `src/components/products/ProductSearch.tsx`
- `src/components/products/ProductFilters.tsx`
- `src/pages/Products.tsx`
- `src/pages/AddProduct.tsx`
- `src/pages/EditProduct.tsx`
- `src/api/products.ts` - Product API functions
- `src/api/categories.ts` - Category API functions
- `src/utils/productUtils.ts` - Product validation and helpers

### Testing Requirements

**Test Coverage:**

- Unit tests for all product components
- Form validation testing (required fields, data types)
- API integration tests for CRUD operations
- Search and filter functionality testing
- Category management testing
- Responsive design testing

### Technical Constraints

**Validation Requirements:**

- Product name: Required, 2-100 characters
- Base price: Required, positive number
- Profit margin: Optional, non-negative number
- Stock: Optional, non-negative integer
- SKU: Optional, unique within shop

**Performance Considerations:**

- Product list pagination (default 20 items per page)
- Search with debouncing (300ms delay)
- Category filtering with caching
- Image optimization for product photos (future enhancement)

**Business Logic:**

- Selling price = Base price + Margin
- Stock status: In-stock (>0), Low-stock (1-10), Out-of-stock (0)
- Products can be soft-deleted (isActive: false)
- Categories are shop-specific

## Testing

**Testing Standards:**

- Unit tests for all product components using React Testing Library
- Form validation testing with various input scenarios
- API integration tests with mocked endpoints
- Search and filter functionality testing
- Responsive design testing across different screen sizes
- Error handling and edge case testing

## Change Log

| Date       | Version | Description            | Author             |
| ---------- | ------- | ---------------------- | ------------------ |
| 2025-01-27 | 1.0     | Initial story creation | Bob (Scrum Master) |

## Dev Agent Record

_This section will be populated by the development agent during implementation_

### Agent Model Used

_To be filled by dev agent_

### Debug Log References

_To be filled by dev agent_

### Completion Notes List

_To be filled by dev agent_

### File List

_To be filled by dev agent_

## QA Results

_This section will be populated by the QA agent during review_
